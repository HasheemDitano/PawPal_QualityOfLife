@model PetAssessmentViewModel
@{
    ViewData["Title"] = "Pet Quality of Life Assessment";
}

<div class="assessment-wrapper">
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-xl-8 col-lg-10">
                <div class="assessment-container">
                    <!-- Header Section -->
                    <div class="assessment-header">
                        <button type="button" class="btn-close-assessment">
                            <i class="fas fa-times"></i>
                        </button>
                        <div class="header-content">
                            <div class="pet-avatar">
                                <i class="fas fa-paw"></i>
                            </div>
                            <h1 class="assessment-title">Pet Quality Assessment</h1>
                            <p class="assessment-subtitle">Step 1: Pet Information</p>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar-modern">
                                <div class="progress-fill" style="width: 33.33%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Form Content -->
                    <div class="assessment-content">
                        <form asp-action="Assessment" method="post" class="modern-form" id="assessmentForm" novalidate>
                            @Html.AntiForgeryToken()
                            
                            <!-- Step 1: Pet Information -->
                            <div class="form-step active" id="step1">
                                <div class="form-grid">
                                    <div class="form-group half-width">
                                        <label asp-for="PetName" class="form-label required">Pet Name</label>
                                        <input asp-for="PetName" class="form-control modern-input" placeholder="Enter your pet's name" />
                                        <span asp-validation-for="PetName" class="validation-error"></span>
                                    </div>
                                    
                                    <div class="form-group half-width">
                                        <label asp-for="PetType" class="form-label required">Pet Type</label>
                                        <select asp-for="PetType" class="form-control modern-select">
                                            <option value="">Select pet type</option>
                                            <option value="Dog">Dog</option>
                                            <option value="Cat">Cat</option>
                                            <option value="Bird">Bird</option>
                                            <option value="Rabbit">Rabbit</option>
                                            <option value="Hamster">Hamster</option>
                                            <option value="Guinea Pig">Guinea Pig</option>
                                            <option value="Ferret">Ferret</option>
                                            <option value="Other">Other</option>
                                        </select>
                                        <span asp-validation-for="PetType" class="validation-error"></span>
                                    </div>
                                    
                                    <div class="form-group full-width">
                                        <label asp-for="PetBreed" class="form-label">Breed</label>
                                        <input asp-for="PetBreed" class="form-control modern-input" placeholder="e.g., Golden Retriever, Mixed Breed" />
                                        <span asp-validation-for="PetBreed" class="validation-error"></span>
                                    </div>
                                    
                                    <div class="form-group half-width">
                                        <label asp-for="PetAge" class="form-label required">Pet Age (years)</label>
                                        <input asp-for="PetAge" class="form-control modern-input" type="number" min="0" max="30" placeholder="Age in years" />
                                        <span asp-validation-for="PetAge" class="validation-error"></span>
                                    </div>
                                    
                                    <div class="form-group half-width">
                                        <label asp-for="OwnerName" class="form-label required">Owner Name</label>
                                        <input asp-for="OwnerName" class="form-control modern-input" placeholder="Your full name" />
                                        <span asp-validation-for="OwnerName" class="validation-error"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 2: Health Assessment -->
                            <div class="form-step" id="step2">
                                <div class="assessment-intro">
                                    <h3>Health & Wellbeing Assessment</h3>
                                    <p>Please rate each category from 1-5 based on your observations:</p>
                                    <div class="rating-guide">
                                        <span class="guide-item">1 = Very Poor</span>
                                        <span class="guide-item">2 = Poor</span>
                                        <span class="guide-item">3 = Fair</span>
                                        <span class="guide-item">4 = Good</span>
                                        <span class="guide-item">5 = Excellent</span>
                                    </div>
                                </div>

                                <div class="assessment-categories">
                                    <!-- Pain Level -->
                                    <div class="category-assessment">
                                        <div class="category-header">
                                            <div class="category-icon pain">
                                                <i class="fas fa-hand-holding-heart"></i>
                                            </div>
                                            <div class="category-info">
                                                <h4>Pain Management</h4>
                                                <p>1 = Severe pain, 5 = No pain visible</p>
                                            </div>
                                        </div>
                                        <div class="rating-scale">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <label class="rating-option">
                                                    <input asp-for="PainLevel" type="radio" value="@i" />
                                                    <span class="rating-circle">@i</span>
                                                </label>
                                            }
                                        </div>
                                        <span asp-validation-for="PainLevel" class="validation-error"></span>
                                    </div>

                                    <!-- Mobility -->
                                    <div class="category-assessment">
                                        <div class="category-header">
                                            <div class="category-icon mobility">
                                                <i class="fas fa-running"></i>
                                            </div>
                                            <div class="category-info">
                                                <h4>Mobility & Movement</h4>
                                                <p>Ability to move around comfortably</p>
                                            </div>
                                        </div>
                                        <div class="rating-scale">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <label class="rating-option">
                                                    <input asp-for="Mobility" type="radio" value="@i" />
                                                    <span class="rating-circle">@i</span>
                                                </label>
                                            }
                                        </div>
                                        <span asp-validation-for="Mobility" class="validation-error"></span>
                                    </div>

                                    <!-- Appetite -->
                                    <div class="category-assessment">
                                        <div class="category-header">
                                            <div class="category-icon appetite">
                                                <i class="fas fa-utensils"></i>
                                            </div>
                                            <div class="category-info">
                                                <h4>Appetite & Eating</h4>
                                                <p>Interest in food and eating habits</p>
                                            </div>
                                        </div>
                                        <div class="rating-scale">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <label class="rating-option">
                                                    <input asp-for="Appetite" type="radio" value="@i" />
                                                    <span class="rating-circle">@i</span>
                                                </label>
                                            }
                                        </div>
                                        <span asp-validation-for="Appetite" class="validation-error"></span>
                                    </div>

                                    <!-- Happiness -->
                                    <div class="category-assessment">
                                        <div class="category-header">
                                            <div class="category-icon happiness">
                                                <i class="fas fa-smile"></i>
                                            </div>
                                            <div class="category-info">
                                                <h4>Happiness & Mood</h4>
                                                <p>Overall contentment and joy</p>
                                            </div>
                                        </div>
                                        <div class="rating-scale">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <label class="rating-option">
                                                    <input asp-for="Happiness" type="radio" value="@i" />
                                                    <span class="rating-circle">@i</span>
                                                </label>
                                            }
                                        </div>
                                        <span asp-validation-for="Happiness" class="validation-error"></span>
                                    </div>

                                    <!-- Activity Level -->
                                    <div class="category-assessment">
                                        <div class="category-header">
                                            <div class="category-icon activity">
                                                <i class="fas fa-bolt"></i>
                                            </div>
                                            <div class="category-info">
                                                <h4>Activity & Energy</h4>
                                                <p>Enthusiasm for play and exercise</p>
                                            </div>
                                        </div>
                                        <div class="rating-scale">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <label class="rating-option">
                                                    <input asp-for="ActivityLevel" type="radio" value="@i" />
                                                    <span class="rating-circle">@i</span>
                                                </label>
                                            }
                                        </div>
                                        <span asp-validation-for="ActivityLevel" class="validation-error"></span>
                                    </div>

                                    <!-- Social Interaction -->
                                    <div class="category-assessment">
                                        <div class="category-header">
                                            <div class="category-icon social">
                                                <i class="fas fa-users"></i>
                                            </div>
                                            <div class="category-info">
                                                <h4>Social Engagement</h4>
                                                <p>Interaction with family and other pets</p>
                                            </div>
                                        </div>
                                        <div class="rating-scale">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <label class="rating-option">
                                                    <input asp-for="SocialInteraction" type="radio" value="@i" />
                                                    <span class="rating-circle">@i</span>
                                                </label>
                                            }
                                        </div>
                                        <span asp-validation-for="SocialInteraction" class="validation-error"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 3: Additional Notes -->
                            <div class="form-step" id="step3">
                                <div class="form-group full-width">
                                    <label asp-for="AdditionalNotes" class="form-label">Additional Observations</label>
                                    <textarea asp-for="AdditionalNotes" class="form-control modern-textarea" rows="6" 
                                              placeholder="Share any additional observations about your pet's behavior, habits, or health concerns..."></textarea>
                                    <span asp-validation-for="AdditionalNotes" class="validation-error"></span>
                                </div>
                            </div>

                            <!-- Navigation Buttons -->
                            <div class="form-navigation">
                                <button type="button" class="btn btn-back" id="btnBack" style="display: none;">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button type="button" class="btn btn-next" id="btnNext">
                                    Next
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                                <button type="submit" class="btn btn-submit" id="btnSubmit" style="display: none;">
                                    Calculate Assessment
                                    <i class="fas fa-calculator"></i>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    let currentStep = 1;
    const totalSteps = 3;
    
    const btnNext = document.getElementById('btnNext');
    const btnBack = document.getElementById('btnBack');
    const btnSubmit = document.getElementById('btnSubmit');
    
    // Update form header based on current step
    function updateHeader() {
        const title = document.querySelector('.assessment-title');
        const subtitle = document.querySelector('.assessment-subtitle');
        const progressFill = document.querySelector('.progress-fill');
        
        const stepTitles = {
            1: { title: 'Pet Quality Assessment', subtitle: 'Step 1: Pet Information' },
            2: { title: 'Pet Quality Assessment', subtitle: 'Step 2: Health Assessment' },
            3: { title: 'Pet Quality Assessment', subtitle: 'Step 3: Additional Notes' }
        };
        
        title.textContent = stepTitles[currentStep].title;
        subtitle.textContent = stepTitles[currentStep].subtitle;
        progressFill.style.width = `${(currentStep / totalSteps) * 100}%`;
    }
    
    // Show specific step
    function showStep(step) {
        document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));
        document.getElementById(`step${step}`).classList.add('active');
        
        btnBack.style.display = step > 1 ? 'flex' : 'none';
        btnNext.style.display = step < totalSteps ? 'flex' : 'none';
        btnSubmit.style.display = step === totalSteps ? 'flex' : 'none';
        
        updateHeader();
    }
    
    // Validate current step
    function validateStep(step) {
        const currentStepEl = document.getElementById(`step${step}`);
        const requiredInputs = currentStepEl.querySelectorAll('input[required], select[required]');
        let isValid = true;
        
        if (step === 1) {
            const petName = document.getElementById('PetName');
            const petType = document.getElementById('PetType');
            const petAge = document.getElementById('PetAge');
            const ownerName = document.getElementById('OwnerName');
            
            if (!petName.value.trim()) isValid = false;
            if (!petType.value) isValid = false;
            if (!petAge.value || petAge.value < 0) isValid = false;
            if (!ownerName.value.trim()) isValid = false;
        }
        
        if (step === 2) {
            const ratings = ['PainLevel', 'Mobility', 'Appetite', 'Happiness', 'ActivityLevel', 'SocialInteraction'];
            for (let rating of ratings) {
                const checked = document.querySelector(`input[name="${rating}"]:checked`);
                if (!checked) isValid = false;
            }
        }
        
        return isValid;
    }
    
    // Next button click
    btnNext.addEventListener('click', function() {
        if (validateStep(currentStep)) {
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
            }
        } else {
            alert('Please fill in all required fields before proceeding.');
        }
    });
    
    // Back button click
    btnBack.addEventListener('click', function() {
        if (currentStep > 1) {
            currentStep--;
            showStep(currentStep);
        }
    });
    
    // Initialize
    showStep(1);
});
</script>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}